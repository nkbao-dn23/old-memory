from pwn import *

debug = 1
if(debug):
	r = process("./proxy")
else:
	r = remote("125.235.240.166", 20120)

r.recvuntil(b'Your choice: />')

def create(index, host, port, size, buffer):
	r.sendline(b'1')
	r.recvuntil(b'Enter request index:')
	r.sendline(str(index))
	r.recvuntil(b'Enter hostname:')
	r.sendline(host)
	r.recvuntil(b'Enter port:')
	r.sendline(str(port))
	r.recvuntil(b'Enter input buffer size:')
	r.sendline(str(size))
	r.recvuntil(b'Fill input buffer')
	r.sendline(buffer)
	r.recvuntil(b'Your choice: />')

def modify(index, host, port, size, buffer):
	r.sendline(b'2')
	r.recvuntil(b'Enter request index:')
	r.sendline(str(index))
	r.recvuntil(b'Enter new hostname:')
	r.sendline(host)
	r.recvuntil(b'Enter new port')
	r.sendline(str(port))
	r.recvuntil(b'Enter new input buffer size:')
	r.sendline(str(size))
	r.recvuntil(b'Fill input buffer:')
	r.sendline(buffer)
	r.recvuntil(b'Your choice: />')

def delete(index):
	r.sendline(b'3')
	r.recvuntil(b'Enter request index:')
	r.sendline(str(index))
	r.recvuntil(b'Your choice: />')

def show():
	r.sendline(b'4')
	r.recvuntil(b'Your choice: />')

def credit():
	r.sendline(b'5')
	r.recvuntil(b'Your choice: />')

def quit():
	r.sendline(b'6')
	r.recvuntil(b'Your choice: />')	


